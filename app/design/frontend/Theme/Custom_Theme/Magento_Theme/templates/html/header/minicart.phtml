<?php
/**
 * Copyright Â© Magento, Inc. All rights reserved.
 * See COPYING.txt for license details.
 */

/** @var $block \Magento\Checkout\Block\Cart\Sidebar */
/** @var \Magento\Framework\View\Helper\SecureHtmlRenderer $secureRenderer */
?>

<div data-block="minicart" class="minicart-wrapper custom-cart">
    <div class="icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" fill="none">
            <path d="M32 31.0938L30.4062 8.75C30.3854 8.54167 30.2917 8.36458 30.125 8.21875C29.9792 8.07292 29.8021 8 29.5938 8H25.9375L19.7812 1.84375C19.6146 1.67708 19.4167 1.59375 19.1875 1.59375C18.9792 1.59375 18.7917 1.67708 18.625 1.84375L17.8438 2.625C17.6771 2.79167 17.5938 2.98958 17.5938 3.21875C17.5938 3.42708 17.6771 3.61458 17.8438 3.78125C17.9896 3.92708 18.1667 4 18.375 4C18.6042 4 18.8021 3.92708 18.9688 3.78125L19.1875 3.53125L23.6562 8H21.125L14.1562 1.03125C14.0104 0.885417 13.8229 0.8125 13.5938 0.8125C13.3854 0.8125 13.1979 0.885417 13.0312 1.03125L6.0625 8H2.40625C2.19792 8 2.01042 8.07292 1.84375 8.21875C1.69792 8.36458 1.61458 8.54167 1.59375 8.75L0 31.1562C0 31.2604 0.0104167 31.3646 0.03125 31.4688C0.0729167 31.5729 0.135417 31.6667 0.21875 31.75C0.28125 31.8333 0.364583 31.8958 0.46875 31.9375C0.572917 31.9792 0.6875 32 0.8125 32H31.1875C31.4167 32 31.6042 31.9271 31.75 31.7812C31.9167 31.6146 32 31.4167 32 31.1875C32 31.1875 32 31.1771 32 31.1562C32 31.1354 32 31.1146 32 31.0938ZM13.5938 2.71875L18.875 8H8.34375L13.5938 2.71875ZM1.65625 30.4062L3.15625 9.59375H6.40625H28.8438L30.3438 30.4062H1.65625ZM16 22.4062C15.125 22.4062 14.2812 22.1771 13.4688 21.7188C12.6771 21.2396 11.9792 20.5729 11.375 19.7188C10.8125 18.8854 10.375 17.9479 10.0625 16.9062C9.75 15.8438 9.59375 14.7396 9.59375 13.5938C9.59375 13.3854 9.66667 13.2083 9.8125 13.0625C9.97917 12.8958 10.1771 12.8125 10.4062 12.8125C10.6146 12.8125 10.7917 12.8958 10.9375 13.0625C11.1042 13.2083 11.1875 13.3854 11.1875 13.5938C11.1875 14.5938 11.3125 15.5417 11.5625 16.4375C11.8333 17.3125 12.2083 18.1042 12.6875 18.8125C13.1458 19.4583 13.6562 19.9583 14.2188 20.3125C14.8021 20.6458 15.3958 20.8125 16 20.8125C16.6042 20.8125 17.1875 20.6458 17.75 20.3125C18.3333 19.9583 18.8542 19.4583 19.3125 18.8125C19.7917 18.1042 20.1562 17.3125 20.4062 16.4375C20.6771 15.5417 20.8125 14.5938 20.8125 13.5938C20.8125 13.3854 20.8854 13.2083 21.0312 13.0625C21.1979 12.8958 21.3854 12.8125 21.5938 12.8125C21.8229 12.8125 22.0104 12.8958 22.1562 13.0625C22.3229 13.2083 22.4062 13.3854 22.4062 13.5938C22.4062 14.7396 22.25 15.8438 21.9375 16.9062C21.625 17.9479 21.1875 18.8854 20.625 19.7188C20.0208 20.5729 19.3125 21.2396 18.5 21.7188C17.7083 22.1771 16.875 22.4062 16 22.4062Z" fill="white"/>
        </svg>
    </div>
    <a class="action showcart" href="<?= $block->escapeUrl($block->getShoppingCartUrl()) ?>"
       data-bind="scope: 'minicart_content'">
        <span class="text"><?= $block->escapeHtml(__('My Cart')) ?></span>
        <span class="counter qty empty"
              data-bind="css: { empty: !!getCartParam('summary_count') == false && !isLoading() },
               blockLoader: isLoading">
            <span class="counter-number">
                <!-- ko if: getCartParam('summary_count') -->
                <!-- ko text: getCartParam('summary_count').toLocaleString(window.LOCALE) --><!-- /ko -->
                <!-- /ko -->
            </span>
            <span class="counter-label">
            <!-- ko if: getCartParam('summary_count') -->
                <!-- ko text: getCartParam('summary_count').toLocaleString(window.LOCALE) --><!-- /ko -->
                <!-- ko i18n: 'items' --><!-- /ko -->
            <!-- /ko -->
            </span>
        </span>
    </a>
    <?php if ($block->getIsNeedToDisplaySideBar()):?>
        <div class="block block-minicart"
             data-role="dropdownDialog"
             data-mage-init='{"dropdownDialog":{
                "appendTo":"[data-block=minicart]",
                "triggerTarget":".showcart",
                "timeout": "2000",
                "closeOnMouseLeave": false,
                "closeOnEscape": true,
                "triggerClass":"active",
                "parentClass":"active",
                "buttons":[]}}'>
            <div id="minicart-content-wrapper" data-bind="scope: 'minicart_content'">
                <!-- ko template: getTemplate() --><!-- /ko -->
            </div>
            <?= $block->getChildHtml('minicart.addons') ?>
        </div>
    <?php else: ?>
        <?php $scriptString = <<<script
            require(['jquery'], function ($) {
                $('a.action.showcart').on('click', function() {
                    $(document.body).trigger('processStart');
                });
            });
script;
        ?>
        <?= /* @noEscape */ $secureRenderer->renderTag('script', [], $scriptString, false); ?>
    <?php endif ?>
    <?= /* @noEscape */ $secureRenderer->renderTag('script', [], 'window.checkout = ' .
     /* @noEscape */ $block->getSerializedConfig(), false); ?>
    <script type="text/x-magento-init">
    {
        "[data-block='minicart']": {
            "Magento_Ui/js/core/app": <?= /* @noEscape */ $block->getJsLayout() ?>
        },
        "*": {
            "Magento_Ui/js/block-loader": "<?= $block->escapeJs(
                $block->escapeUrl($block->getViewFileUrl('images/loader-1.gif'))
            ) ?>"
        }
    }
    </script>
</div>
